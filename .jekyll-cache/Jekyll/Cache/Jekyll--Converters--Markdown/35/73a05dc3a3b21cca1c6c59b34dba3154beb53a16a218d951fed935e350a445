I"Â<h3 id="ä¸€åˆ©ç”¨urllibçˆ¬å–ç½‘é¡µ">ä¸€ã€åˆ©ç”¨Urllibçˆ¬å–ç½‘é¡µ</h3>
<h5 id="1å¯¼å…¥å¯¹åº”æ¨¡å—">1.å¯¼å…¥å¯¹åº”æ¨¡å—ï¼š</h5>

<p>â€ƒâ€ƒå› ä¸ºPython 3.*ç‰ˆæœ¬ä¸­å°†urllibå’Œurllib2åˆå¹¶ä¸ºurllibï¼Œæ‰€ä»¥ç›´æ¥</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib.request</span>
</code></pre></div></div>
<h5 id="2ä½¿ç”¨-urllibrequesturlopenurlæ‰“å¼€å¹¶çˆ¬å–ä¸€ä¸ªç½‘é¡µ">2.ä½¿ç”¨ urllib.request.urlopen(url)æ‰“å¼€å¹¶çˆ¬å–ä¸€ä¸ªç½‘é¡µ</h5>

<p>â€ƒâ€ƒè¿™é‡Œå°†ç™¾åº¦ä½œä¸ºä¾‹å­</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">"http://www.baidu.com"</span><span class="p">)</span>
</code></pre></div></div>
<h5 id="3å°†å¯¹åº”ç½‘é¡µçš„å†…å®¹è¯»å–å‡ºæ¥">3.å°†å¯¹åº”ç½‘é¡µçš„å†…å®¹è¯»å–å‡ºæ¥</h5>

<p>â€ƒâ€ƒè¯»å–å†…å®¹çš„å¸¸è§æ–¹å¼æœ‰3ç§ï¼š</p>
<ol>
  <li>file.read() è¯»å–æ–‡ä»¶å…¨éƒ¨å†…å®¹ï¼ŒæŠŠè¯»å–åˆ°çš„å†…å®¹èµ‹ç»™ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ï¼›</li>
  <li>file.readlines() è¯»å–æ–‡ä»¶å…¨éƒ¨å†…å®¹ï¼Œ æŠŠè¯»å–åˆ°çš„å†…å®¹èµ‹ç»™ä¸€ä¸ªåˆ—è¡¨å˜é‡ï¼Œè‹¥è¦è¯»å–å…¨éƒ¨å†…å®¹ï¼Œæ¨èè¿™ç§æ–¹å¼ï¼›</li>
  <li>file.readline() è¯»å–æ–‡ä»¶çš„ä¸€è¡Œå†…å®¹ã€‚</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataline</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">readline</span><span class="p">()</span>
</code></pre></div></div>
<p>â€ƒâ€ƒè¿™é‡Œåˆ†åˆ«å°†çˆ¬å–çš„ç½‘é¡µçš„å…¨éƒ¨å†…å®¹å’Œä¸€è¡Œå†…å®¹åˆ†åˆ«èµ‹ç»™å˜é‡data, dataline</p>

<p>â€ƒâ€ƒè‹¥æƒ³è¾“å‡ºçˆ¬å–åˆ°çš„å†…å®¹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨print() :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="n">dataline</span><span class="p">)</span>
</code></pre></div></div>

<h5 id="4ä¿å­˜çˆ¬å–çš„ç½‘é¡µå†…å®¹">4.ä¿å­˜çˆ¬å–çš„ç½‘é¡µå†…å®¹</h5>

<p>Â æ­¥éª¤ï¼ša. çˆ¬å–ä¸€ä¸ªç½‘ç«™è¯»å–å‡ºæ¥å¹¶èµ‹ç»™ä¸€ä¸ªå˜é‡ï¼›</p>

<p>Â Â Â Â Â Â Â Â Â  Â b.ä»¥å†™å…¥çš„æ–¹å¼æ‰“å¼€ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ï¼Œä½¿ç”¨ .htmlåç¼€ï¼›</p>

<p>Â Â Â Â Â Â Â Â Â  Â c.å°†aä¸­çš„å˜é‡çš„å€¼å†™å…¥æ–‡ä»¶ï¼›</p>

<p>Â Â Â Â Â Â Â Â Â  Â d.å…³é—­æ–‡ä»¶</p>

<p>request = urllib.request.urlopen(â€œhttp://www.baidu.comâ€)
data = request.read()
file = open(â€œD:/Python/test.htmlâ€, â€˜wbâ€™)
file.write(data)
file.close()
æ­¤å¤–ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ç›´æ¥å†™å…¥æ–‡ä»¶ï¼š</p>

<p>filename = urllib.request.urlretrieve(url, filename = â€œD:/Python/test.htmlâ€)</p>

<p>Â  Â  å¯ä»¥ä½¿ç”¨ç”¨ urllib.request.cleanup()æ¸…ç©ºä½¿ç”¨urlretrieveäº§ç”Ÿçš„ç¼“å­˜ã€‚</p>

<h5 id="5å…¶ä»–">5.å…¶ä»–</h5>

<p>1). ä½¿ç”¨ request.getcode() å¯ä»¥è¿”å›çˆ¬å–ç½‘é¡µçš„çŠ¶æ€ç ï¼Œè‹¥ä¸º200åˆ™çˆ¬å–æ­£å¸¸;</p>

<p>2). ä½¿ç”¨ request.geturl()è¿”å›çˆ¬å–ç½‘é¡µçš„url;</p>

<p>3). ä¸€èˆ¬æ¥è¯´ï¼ŒURLæ ‡å‡†ä¸­åªä¼šå…è®¸ä¸€éƒ¨åˆ†ASCâ…¡å­—ç¬¦ï¼Œè‹¥è¦åœ¨å…¶ä¸­ä½¿ç”¨æ±‰å­—ç­‰å…¶ä»–å­—ç¬¦ï¼Œéœ€å¯¹urlè¿›è¡Œç¼–ç ï¼ˆè¿™é‡Œä»¥æ·˜å®ä¸ºä¾‹ï¼‰ï¼š</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">quote</span><span class="p">(</span><span class="s">"http://www.taobao.com"</span><span class="p">)</span>
<span class="s">'http%3A//www.taobao.com'</span>
</code></pre></div></div>

<p>â€ƒâ€ƒç›¸åº”åœ°ï¼Œå¯¹urlè¿›è¡Œè§£ç è¯—å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ“ä½œï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">unquote</span><span class="p">(</span><span class="s">"http%3A//www.taobao.com"</span><span class="p">)</span>
<span class="s">'http://www.taobao.com'</span>
</code></pre></div></div>

<h5 id="6æ¨¡æ‹Ÿæµè§ˆå™¨">6.æ¨¡æ‹Ÿæµè§ˆå™¨</h5>

<p>â€ƒâ€ƒç”¨çˆ¬è™«ç›´æ¥çˆ¬å–ç½‘é¡µæ—¶ï¼Œrequestä¸­çš„headerä¼šæ˜¾ç¤ºå…¶ä¸ºçˆ¬è™«ï¼ŒæŸäº›ç½‘é¡µä¸ºäº†é˜²æ­¢çˆ¬è™«é‡‡é›†ä¿¡æ¯ä¼šè¿›è¡Œåçˆ¬è™«è®¾ç½®ã€‚æ­¤æ—¶ä¸ºäº†æˆåŠŸçˆ¬å–è¯¥ç½‘é¡µï¼Œéœ€ä»¥æµè§ˆå™¨çš„èº«ä»½è¿›è¡Œçˆ¬å–ã€‚å› æ­¤éœ€è¦ä¿®æ”¹Headerså±æ€§â€”â€”å°†é”®â€˜user-agentâ€™çš„å€¼ä¿®æ”¹ä¸ºâ€˜Mozilla/5.0â€™</p>

<h6 id="æ–¹æ³•ä¸€ä½¿ç”¨-build_opnerä¿®æ”¹æŠ¥å¤´">æ–¹æ³•ä¸€ï¼šÂ ä½¿ç”¨ build_opner()ä¿®æ”¹æŠ¥å¤´</h6>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">opener</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">build_opener</span><span class="p">()</span>
<span class="n">opener</span><span class="p">.</span><span class="n">adddheaders</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">'User-Agent'</span><span class="p">,</span><span class="s">'Mozilla/5.0'</span><span class="p">)</span> <span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">opener</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
</code></pre></div></div>
<h6 id="æ–¹æ³•äºŒä½¿ç”¨-add_headersæ·»åŠ æŠ¥å¤´">æ–¹æ³•äºŒï¼šÂ ä½¿ç”¨ add_headers()æ·»åŠ æŠ¥å¤´</h6>

<p>é¦–å…ˆä½¿ç”¨urllib.request.Request(url)åˆ›å»ºä¸€ä¸ªRequestå¯¹è±¡å¹¶èµ‹ç»™requestï¼Œç„¶åä½¿ç”¨add_header()æ·»åŠ å¯¹åº”çš„æŠ¥å¤´ä¿¡æ¯</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span> <span class="o">=</span> <span class="s">"http://www.baidu.com"</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'User-Agent'</span><span class="p">,</span> <span class="s">'Mozilla/5.0'</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
</code></pre></div></div>

<h5 id="7è¶…æ—¶è®¾ç½®">7.è¶…æ—¶è®¾ç½®</h5>

<p>â€ƒâ€ƒæœ‰æ—¶è®¿é—®ä¸€ä¸ªç½‘é¡µï¼Œå…¶é•¿æ—¶é—´æœªååº”ï¼Œç³»ç»Ÿä¼šåˆ¤æ–­è®¿é—®è¶…æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±è®¾ç½®é™åˆ¶çš„è¶…æ—¶è®¿é—®æ—¶é—´</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">"htttp://www.baidu.com"</span><span class="p">,</span> <span class="n">timeout</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
</code></pre></div></div>
<p>â€ƒâ€ƒå…¶ä¸­ï¼Œtimeoutçš„å•ä½ä¸ºç§’ã€‚</p>

<p>â€ƒâ€ƒä¾‹ä¸­è‹¥å‘ç½‘é¡µå‘é€è¯·æ±‚åæœåŠ¡å™¨åœ¨30så†…æœªå“åº”ï¼Œåˆ™ä¼šå¼•å‘å¼‚å¸¸ã€‚</p>
:ET