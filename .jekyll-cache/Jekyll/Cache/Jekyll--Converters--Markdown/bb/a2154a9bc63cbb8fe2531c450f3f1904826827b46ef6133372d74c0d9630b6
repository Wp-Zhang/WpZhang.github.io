I"ö™<p>ä»Šå¤©å‡ºå…­çº§æˆç»©ï¼Œå¾ˆå¤šäººåœ¨æˆç»©å‡ºæ¥ä¹‹åçš„ä¸€æ®µæ—¶é—´éƒ½æŸ¥è¯¢ä¸åˆ°è‡ªå·±çš„æˆç»©ã€‚æ™šä¸Šæœ‰ç©ºå°±å†™äº†ä¸€ä¸ªçˆ¬è™«ã€‚</p>

<hr />

<p>é¦–å…ˆè¿›å…¥æŸ¥è¯¢å››ã€å…­çº§æˆç»©çš„ç½‘é¡µï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯â€œhttp://cet.neea.edu.cn/cetâ€</p>

<p>è¿›å…¥ä¹‹åå‘ç°ä¸èƒ½å³é”®æŸ¥çœ‹æºä»£ç ï¼Œä¸è¿‡ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œç›´æ¥æ‰“å¼€å¼€å‘è€…å·¥å…·
è¾“å…¥å‰ä¸¤ä¸ªä¿¡æ¯åç‚¹å‡»éªŒè¯ç è¾“å…¥æ¡†ï¼Œå‘ç°å‡ºç°ä¸¤ä¸ªæ–°çš„GETè¯·æ±‚ã€‚æ˜¾ç„¶è¿™æ˜¯è·å–éªŒè¯ç çš„ç›¸å…³è¯·æ±‚ã€‚ç‚¹å‡»ç¬¬ä¸€ä¸ªè¯·æ±‚ï¼Œå¯ä»¥å‘ç°éªŒè¯ç å›¾ç‰‡é“¾æ¥å°±åœ¨å…¶ä¸­</p>

<p><img src="/media/editor/20180822222423984_20190219135833801350.png" alt="" /></p>

<p>åæœŸå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ç›´æ¥æå–ã€‚å†çœ‹è¯·æ±‚ä¿¡æ¯ã€‚</p>

<p><img src="/media/editor/20180822222445166_20190219135854997045.png" alt="" /></p>

<p>å¯è§æ­¤GETè¯·æ±‚çš„urlçš„å‚æ•°åŒ…å«3ä¸ªå‚æ•°ï¼š</p>

<ol>
  <li>è€ƒè¯•ç±»åˆ«ã€‚è¿™é‡Œæ˜¯æŸ¥è¯¢è‹±è¯­å››å…­çº§æˆç»©ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®ä¸ºå›ºå®šçš„â€™CETâ€™</li>
  <li>å‡†è€ƒè¯å·</li>
  <li>ä¸€ä¸ªå°æ•°</li>
</ol>

<p>ç¬¬ä¸‰ä¸ªå‚æ•°åˆæ­¥çŒœæµ‹æ˜¯ä¸€ä¸ªéšæœºæ•°ï¼Œä½†æ˜¯ä¸ç¡®å®šã€‚å¯ä»¥çœ‹è§è¯¥ç½‘é¡µçš„JavaScriptæºç </p>

<p><img src="/media/editor/20180822222457373_20190219135915933286.png" alt="" /></p>

<p>å¯ä»¥æ‰¾åˆ°ç½‘ç«™æ„é€ è¯·æ±‚çš„æ–¹æ³•ã€‚å…¶ä¸­çš„<code class="language-plaintext highlighter-rouge">Math.random()</code>è¯´æ˜ä¹‹å‰çš„çŒœæµ‹æ˜¯æ­£ç¡®çš„ã€‚</p>

<p>ç„¶ååœ¨è¯·æ±‚è¿”å›çš„å†…å®¹ä¸­æå–å›¾ç‰‡åœ°å€ï¼š<code class="language-plaintext highlighter-rouge">img_url = re.compile('"(.*?)"').findall(response.text)[0]</code></p>

<p>è·å–éªŒè¯ç å›¾ç‰‡å¹¶ä¿å­˜åˆ°æœ¬åœ°çš„ä»£ç å¦‚ä¸‹ï¼ˆå› ä¸ºæœ‰éªŒè¯ç çš„ç›¸å…³æ“ä½œï¼Œæ‰€ä»¥æ¶‰åŠåˆ°Cookiesï¼Œä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ä¼šè¯Sessionï¼‰ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#å¾—åˆ°ç›¸å…³è€ƒç”Ÿä¿¡æ¯
</span><span class="k">def</span> <span class="nf">get_info</span><span class="p">():</span>
    <span class="n">id_num</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"è¾“å…¥å‡†è€ƒè¯å·ï¼š"</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"è¾“å…¥å§“åï¼š"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span>

<span class="c1">#è·å–å›¾ç‰‡
</span><span class="k">def</span> <span class="nf">get_img</span><span class="p">(</span><span class="n">Session</span><span class="p">,</span> <span class="n">id_numm</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'Connection'</span><span class="p">:</span> <span class="s">'keep - alive'</span><span class="p">,</span>
            <span class="s">'Host'</span><span class="p">:</span> <span class="s">'cache.neea.edu.cn'</span><span class="p">,</span>
            <span class="s">'Referer'</span><span class="p">:</span> <span class="s">'http://cet.neea.edu.cn/cet'</span><span class="p">,</span>
            <span class="s">'User-Agent'</span><span class="p">:</span> <span class="s">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3486.0 Safari/537.36'</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">Session</span><span class="p">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span>
        <span class="n">get_url</span> <span class="o">=</span> <span class="s">'http://cache.neea.edu.cn/Imgs.do?'</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'c'</span><span class="p">:</span> <span class="s">'CET'</span><span class="p">,</span>
            <span class="s">'ik'</span><span class="p">:</span> <span class="n">id_numm</span><span class="p">,</span>
            <span class="s">'t'</span><span class="p">:</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">Session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">get_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="n">img_url</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'"(.*?)"'</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">img_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'D:/img.png'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">img</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Imgae_Error:"</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></div>

<p>æœ¬æ¥æƒ³ä½¿ç”¨tesserocræ¥è¿›è¡Œå›¾ç‰‡è¯†åˆ«ï¼Œç»“æœå‘ç°å¦‚æœä¸å¯¹å›¾ç‰‡è¿›è¡Œè¾ƒå¤šçš„é¢„å¤„ç†ï¼Œä¸èƒ½ç›´æ¥è¯†åˆ«å‡ºå›¾ç‰‡ä¸­çš„éªŒè¯ç ï¼Œäºæ˜¯ç›´æ¥ç®€å•ç²—æš´çš„è®©ç”¨æˆ·è¾“å…¥ï¼šï¼‰</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">def</span> <span class="nf">get_score</span><span class="p">(</span><span class="n">Session</span><span class="p">,</span> <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
    <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'D:/img.png'</span><span class="p">).</span><span class="n">show</span><span class="p">()</span>
    <span class="n">capcha</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'è¯·æ‰“å¼€å›¾ç‰‡è¾“å…¥éªŒè¯ç :'</span><span class="p">)</span>
</code></pre></div></div>

<p>åˆ°è¿™é‡Œï¼Œå¯ä»¥å¼€å§‹æ„é€ æŸ¥è¯¢æˆç»©çš„è¯·æ±‚äº†ã€‚å†åˆ†æè¯·æ±‚ä¿¡æ¯ï¼šåœ¨è¾“å…¥æ­£ç¡®ä¿¡æ¯åè§‚å¯Ÿ</p>

<p><img src="/media/editor/20180822222514966_20190219135943152996.png" alt="" /></p>

<p>æ‰¾åˆ°æŸ¥è¯¢æˆç»©çš„POSTè¯·æ±‚ï¼ŒæŸ¥çœ‹å…¶ä¿¡æ¯ï¼š</p>

<p><img src="/media/editor/20180822222526854_20190219140005301705.png" alt="" /></p>

<p>å‘ç°ä¼ é€’çš„æ•°æ®ä¸­æœ‰ä¸¤é¡¹ï¼š</p>
<ol>
  <li>åŒ…å«ä¸‰ä¸ªå‚æ•°ï¼šè€ƒè¯•ä»£ç ï¼Œå‡†è€ƒè¯è€ƒï¼Œè€ƒç”Ÿå§“å</li>
  <li>éªŒè¯ç </li>
</ol>

<p>å†çœ‹è®¿é—®ç½‘é¡µæ—¶äº§ç”Ÿçš„è¯·æ±‚ï¼Œå‘ç°data.jsä¸­æœ‰ç›¸å…³ä¿¡æ¯ï¼š</p>

<p><img src="/media/editor/20180822222545643_20190219140027183709.png" alt="" /></p>

<p>å¯è§tabå¯¹åº”çš„valueå°±æ˜¯è€ƒè¯•ä»£ç ã€‚è€Œä¸Šç½‘æŸ¥è¯¢å¯çŸ¥å‡†è€ƒè¯è€ƒä¸­çš„ç¬¬ä¹ä½æ˜¯åˆ¤æ–­è€ƒè¯•ç±»åˆ«çš„ã€‚è‡³æ­¤ï¼ŒPOSTè¯·æ±‚åˆ†æç»“æŸï¼Œå¼€å§‹å†™ä»£ç ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_info</span><span class="p">():</span>
    <span class="n">id_num</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"è¾“å…¥å‡†è€ƒè¯å·ï¼š"</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"è¾“å…¥å§“åï¼š"</span><span class="p">)</span>
    <span class="n">level</span> <span class="o">=</span> <span class="n">id_num</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">level</span>

<span class="k">def</span> <span class="nf">get_score</span><span class="p">(</span><span class="n">Session</span><span class="p">,</span> <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
    <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'D:/img.png'</span><span class="p">).</span><span class="n">show</span><span class="p">()</span>
    <span class="n">capcha</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'è¯·æ‰“å¼€å›¾ç‰‡è¾“å…¥éªŒè¯ç :'</span><span class="p">)</span>
    
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'Connection'</span><span class="p">:</span> <span class="s">'keep - alive'</span><span class="p">,</span>
            <span class="s">'Host'</span><span class="p">:</span> <span class="s">'cache.neea.edu.cn'</span><span class="p">,</span>
            <span class="s">'Origin'</span><span class="p">:</span> <span class="s">'http://cet.neea.edu.cn'</span><span class="p">,</span>
            <span class="s">'Referer'</span><span class="p">:</span> <span class="s">'http://cet.neea.edu.cn/cet'</span><span class="p">,</span>
            <span class="s">'User-Agent'</span><span class="p">:</span> <span class="s">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3486.0 Safari/537.36'</span><span class="p">,</span>
        <span class="p">}</span>
    
        <span class="n">query_url</span> <span class="o">=</span> <span class="s">"http://cache.neea.edu.cn/cet/query"</span>
    
        <span class="n">test</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'1'</span><span class="p">:</span> <span class="s">'CET4_181_DANGCI'</span><span class="p">,</span>
            <span class="s">'2'</span><span class="p">:</span> <span class="s">'CET6_181_DANGCI'</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'data'</span><span class="p">:</span> <span class="n">test</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="o">+</span> <span class="s">','</span> <span class="o">+</span> <span class="n">id_num</span> <span class="o">+</span> <span class="s">','</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span>
            <span class="s">'v'</span><span class="p">:</span> <span class="n">capcha</span>
        <span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">Session</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">query_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</code></pre></div></div>

<p>å†è§‚å¯Ÿqueryè¿™ä¸ªPOSTè¯·æ±‚çš„Responseéƒ¨åˆ†ï¼ˆå›¾ç‰‡ä¸Šé¢æœ‰ï¼‰ï¼Œå¯ä»¥å‘ç°ä¿¡æ¯å­˜å‚¨çš„è§„å¾‹ï¼ŒåŒæ ·ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–å¹¶æ˜¾ç¤ºå‡ºæ¥ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">id_num</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"z:'(.*?)'"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"n:'(.*?)'"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">school</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"x:'(.*?)'"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"s:(.*?),"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">listening</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"l:(.*?),"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">reading</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"r:(.*?),"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">writing</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"w:(.*?),"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rank</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"kys:'(.*?)'"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">level</span><span class="o">==</span><span class="s">'1'</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">====================</span><span class="se">\n\n</span><span class="s">å››çº§ç¬”è¯•æˆç»©ï¼š"</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">level</span><span class="o">==</span><span class="s">'2'</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">====================</span><span class="se">\n\n</span><span class="s">å…­çº§ç¬”è¯•æˆç»©ï¼š"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"å‡†è€ƒè¯å·ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">id_num</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"å§“åï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"å­¦æ ¡ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">school</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"æ€»åˆ†ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"å¬åŠ›ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">listening</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"é˜…è¯»ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">reading</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"å†™ä½œä¸ç¿»è¯‘ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">writing</span><span class="p">))</span>
<span class="k">if</span> <span class="n">level</span><span class="o">==</span><span class="s">'1'</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">====================</span><span class="se">\n\n</span><span class="s">å››çº§å£è¯•æˆç»©ï¼š"</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">level</span><span class="o">==</span><span class="s">'2'</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">====================</span><span class="se">\n\n</span><span class="s">å…­çº§å£è¯•æˆç»©ï¼š"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"ç­‰çº§ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rank</span><span class="p">))</span>
</code></pre></div></div>

<p>è‡³æ­¤ï¼Œä¸»è¦å‡½æ•°å°±æ„é€ å®Œæˆã€‚å†™ä¸»å‡½æ•°ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span> <span class="p">,</span><span class="n">level</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">get_img</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">id_num</span><span class="p">)</span>
    <span class="n">get_score</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
    <span class="c1">#åæœŸæ‰“åŒ…æˆ.exeæ—¶æœ‰ç”¨ï¼Œå¦‚æœä¸æ‰“åŒ…ï¼Œå¯ä»¥åˆ æ‰
</span>    <span class="c1">#end = input("è¾“å…¥ä»»æ„é”®é€€å‡º...") 
</span></code></pre></div></div>
<p>å››å…­çº§æˆç»©æŸ¥è¯¢çš„çˆ¬è™«å°±å†™å¥½äº†ï¼š</p>

<p><img src="/media/editor/20180822222633742_20190219140052839777.png" alt="" /></p>

<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>

<span class="k">def</span> <span class="nf">get_info</span><span class="p">():</span>
    <span class="n">id_num</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"è¾“å…¥å‡†è€ƒè¯å·ï¼š"</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"è¾“å…¥å§“åï¼š"</span><span class="p">)</span>
    <span class="n">level</span> <span class="o">=</span> <span class="n">id_num</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">level</span>

<span class="k">def</span> <span class="nf">get_img</span><span class="p">(</span><span class="n">Session</span><span class="p">,</span> <span class="n">id_numm</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'Connection'</span><span class="p">:</span> <span class="s">'keep - alive'</span><span class="p">,</span>
            <span class="s">'Host'</span><span class="p">:</span> <span class="s">'cache.neea.edu.cn'</span><span class="p">,</span>
            <span class="s">'Referer'</span><span class="p">:</span> <span class="s">'http://cet.neea.edu.cn/cet'</span><span class="p">,</span>
            <span class="s">'User-Agent'</span><span class="p">:</span> <span class="s">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3486.0 Safari/537.36'</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">Session</span><span class="p">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span>
        <span class="n">get_url</span> <span class="o">=</span> <span class="s">'http://cache.neea.edu.cn/Imgs.do?'</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'c'</span><span class="p">:</span> <span class="s">'CET'</span><span class="p">,</span>
            <span class="s">'ik'</span><span class="p">:</span> <span class="n">id_numm</span><span class="p">,</span>
            <span class="s">'t'</span><span class="p">:</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">Session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">get_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="n">img_url</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'"(.*?)"'</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">img_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'D:/img.png'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">img</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'D:/img.png'</span><span class="p">).</span><span class="n">show</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Imgae_Error:"</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">args</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_score</span><span class="p">(</span><span class="n">Session</span><span class="p">,</span> <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
    <span class="n">capcha</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'è¯·æ‰“å¼€å›¾ç‰‡è¾“å…¥éªŒè¯ç :'</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Connection'</span><span class="p">:</span> <span class="s">'keep - alive'</span><span class="p">,</span>
        <span class="s">'Host'</span><span class="p">:</span> <span class="s">'cache.neea.edu.cn'</span><span class="p">,</span>
        <span class="s">'Origin'</span><span class="p">:</span> <span class="s">'http://cet.neea.edu.cn'</span><span class="p">,</span>
        <span class="s">'Referer'</span><span class="p">:</span> <span class="s">'http://cet.neea.edu.cn/cet'</span><span class="p">,</span>
        <span class="s">'User-Agent'</span><span class="p">:</span> <span class="s">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3486.0 Safari/537.36'</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">query_url</span> <span class="o">=</span> <span class="s">"http://cache.neea.edu.cn/cet/query"</span>

    <span class="n">test</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'1'</span><span class="p">:</span> <span class="s">'CET4_181_DANGCI'</span><span class="p">,</span>
        <span class="s">'2'</span><span class="p">:</span> <span class="s">'CET6_181_DANGCI'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'data'</span><span class="p">:</span> <span class="n">test</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="o">+</span> <span class="s">','</span> <span class="o">+</span> <span class="n">id_num</span> <span class="o">+</span> <span class="s">','</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span>
        <span class="s">'v'</span><span class="p">:</span> <span class="n">capcha</span>
    <span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">Session</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">query_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">if</span> <span class="s">'error'</span> <span class="ow">in</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"'error':'(.*?)'|error:'(.*?)'"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1">#print(e)
</span>            <span class="k">if</span> <span class="s">'éªŒè¯ç é”™è¯¯'</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"éªŒè¯ç è¾“å…¥é”™è¯¯ï¼"</span><span class="p">)</span>
                <span class="n">get_img</span><span class="p">(</span><span class="n">Session</span><span class="p">,</span> <span class="n">id_num</span><span class="p">)</span>
                <span class="n">get_score</span><span class="p">(</span><span class="n">Session</span><span class="p">,</span> <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">id_num</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"z:'(.*?)'"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"n:'(.*?)'"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">school</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"x:'(.*?)'"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"s:(.*?),"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">listening</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"l:(.*?),"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reading</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"r:(.*?),"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">writing</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"w:(.*?),"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"kys:'(.*?)'"</span><span class="p">).</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">level</span><span class="o">==</span><span class="s">'1'</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">====================</span><span class="se">\n\n</span><span class="s">å››çº§ç¬”è¯•æˆç»©ï¼š"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">level</span><span class="o">==</span><span class="s">'2'</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">====================</span><span class="se">\n\n</span><span class="s">å…­çº§ç¬”è¯•æˆç»©ï¼š"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"å‡†è€ƒè¯å·ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">id_num</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"å§“åï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"å­¦æ ¡ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">school</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"æ€»åˆ†ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"å¬åŠ›ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">listening</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"é˜…è¯»ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">reading</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"å†™ä½œä¸ç¿»è¯‘ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">writing</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">level</span><span class="o">==</span><span class="s">'1'</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">====================</span><span class="se">\n\n</span><span class="s">å››çº§å£è¯•æˆç»©ï¼š"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">level</span><span class="o">==</span><span class="s">'2'</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">====================</span><span class="se">\n\n</span><span class="s">å…­çº§å£è¯•æˆç»©ï¼š"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"ç­‰çº§ï¼š"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rank</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span> <span class="p">,</span><span class="n">level</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">get_img</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">id_num</span><span class="p">)</span>
    <span class="n">get_score</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">id_num</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"è¾“å…¥ä»»æ„é”®é€€å‡º..."</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>
:ET